<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Cost Multiplier Warnings</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">تست هشدارهای ضریب هزینه</h1>
        
        <!-- Welcome Area Test -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>ناحیه خوش‌آمدگویی</h5>
            </div>
            <div class="card-body">
                <div class="model-selection-container p-3 bg-light rounded" id="welcome-model-selection">
                    <h5 class="mb-3">
                        <i class="fas fa-microchip"></i> انتخاب مدل هوش مصنوعی
                    </h5>
                    <div class="mb-3">
                        <select class="form-select form-select-lg" id="welcome-model-select">
                            <option value="">-- مدلی را انتخاب کنید --</option>
                            <option value="gpt-3.5">GPT-3.5 Turbo (ضریب: 1.0)</option>
                            <option value="gpt-4">GPT-4 (ضریب: 1.5)</option>
                            <option value="claude">Claude 3 (ضریب: 2.0)</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal Test -->
        <div class="card">
            <div class="card-header">
                <h5>ناحیه مودال ایجاد چت جدید</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label">انتخاب چت‌بات:</label>
                    <select class="form-select" id="modal-chatbot-select">
                        <option value="">-- چت‌باتی را انتخاب کنید --</option>
                        <option value="1">چت‌بات عمومی</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">انتخاب مدل:</label>
                    <select class="form-select" id="modal-model-select">
                        <option value="">-- مدلی را انتخاب کنید --</option>
                        <option value="gpt-3.5" data-token-cost-multiplier="1.0">GPT-3.5 Turbo</option>
                        <option value="gpt-4" data-token-cost-multiplier="1.5">GPT-4</option>
                        <option value="claude" data-token-cost-multiplier="2.0">Claude 3</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="create-chat-btn">ایجاد چت</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Mock the global variables and functions we need
        let availableModelsData = [
            { model_id: "gpt-3.5", name: "GPT-3.5 Turbo", token_cost_multiplier: 1.0 },
            { model_id: "gpt-4", name: "GPT-4", token_cost_multiplier: 1.5 },
            { model_id: "claude", name: "Claude 3", token_cost_multiplier: 2.0 }
        ];
        
        // Simple implementation of our warning functions for testing
        function showCostMultiplierWarning(model) {
            let warningElement = document.getElementById('cost-multiplier-warning');
            if (!warningElement) {
                warningElement = document.createElement('div');
                warningElement.id = 'cost-multiplier-warning';
                warningElement.className = 'alert alert-warning alert-dismissible fade show mt-3';
                warningElement.role = 'alert';
                warningElement.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>هشدار هزینه!</strong>
                    <span id="warning-text"></span>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                `;
                const modelSelectionContainer = document.getElementById('welcome-model-selection');
                modelSelectionContainer.parentNode.insertBefore(warningElement, modelSelectionContainer.nextSibling);
            }
            
            const multiplier = model.token_cost_multiplier;
            const warningText = document.getElementById('warning-text');
            warningText.textContent = ` این مدل هوش مصنوعی دارای ضریب هزینه ${multiplier} است و به ازای هر توکن مصرفی، ${multiplier} توکن از اعتبار شما کسر خواهد شد.`;
            warningElement.style.display = 'block';
        }
        
        function hideCostMultiplierWarning() {
            const warningElement = document.getElementById('cost-multiplier-warning');
            if (warningElement) {
                warningElement.style.display = 'none';
            }
        }
        
        function showModalCostWarning(multiplier) {
            let warningElement = document.getElementById('modal-cost-warning');
            if (!warningElement) {
                warningElement = document.createElement('div');
                warningElement.id = 'modal-cost-warning';
                warningElement.className = 'alert alert-warning mt-3';
                warningElement.role = 'alert';
                warningElement.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>هشدار هزینه!</strong>
                    <span id="modal-warning-text"></span>
                `;
                const createBtn = document.getElementById('create-chat-btn');
                createBtn.parentNode.insertBefore(warningElement, createBtn);
            }
            
            const warningText = document.getElementById('modal-warning-text');
            warningText.textContent = ` این مدل هوش مصنوعی دارای ضریب هزینه ${multiplier} است و به ازای هر توکن مصرفی، ${multiplier} توکن از اعتبار شما کسر خواهد شد.`;
            warningElement.style.display = 'block';
        }
        
        function hideModalCostWarning() {
            const warningElement = document.getElementById('modal-cost-warning');
            if (warningElement) {
                warningElement.style.display = 'none';
            }
        }
        
        // Event listeners
        document.getElementById('welcome-model-select').addEventListener('change', function() {
            const selectedModelId = this.value;
            if (selectedModelId) {
                const selectedModel = availableModelsData.find(model => model.model_id === selectedModelId);
                if (selectedModel && selectedModel.token_cost_multiplier > 1) {
                    showCostMultiplierWarning(selectedModel);
                } else {
                    hideCostMultiplierWarning();
                }
            } else {
                hideCostMultiplierWarning();
            }
        });
        
        document.getElementById('modal-model-select').addEventListener('change', function() {
            const selectedOption = this.options[this.selectedIndex];
            const costMultiplier = parseFloat(selectedOption.dataset.tokenCostMultiplier);
            
            if (costMultiplier > 1) {
                showModalCostWarning(costMultiplier);
            } else {
                hideModalCostWarning();
            }
        });
        
        console.log("Test page loaded. Try selecting different models to see warnings.");
    </script>
</body>
</html>