# ุฑุงูููุง ุญู ูุดฺฉู ูุงฺฏุฑุดูโูุง ุฏุฑ Production

## ๐จ ูุดฺฉู
ุฎุทุง ูุงฺฏุฑุดู Django ุฏุฑ ุณุฑูุฑ production:
```
NodeNotFoundError: Migration chatbot.0031_messagefile dependencies reference nonexistent parent node ('chatbot', '0030_add_disabled_field_to_chatmessage')
```

## ๐ ุชุดุฎุต ูุดฺฉู
ูุงฺฏุฑุดู `0031_messagefile` ุจู ูุงฺฏุฑุดู `0030_add_disabled_field_to_chatmessage` ูุงุจุณุชู ุงุณุช ฺฉู ููฺฉู ุงุณุช ุฏุฑ ุณุฑูุฑ production ููุฌูุฏ ูุจุงุดุฏ ุง ูุงู ูุชูุงูุช ุฏุงุดุชู ุจุงุดุฏ.

## โ ุฑุงู ุญู ุงุนูุงู ุดุฏู

### 1. ุจุฑุฑุณ ูุงูโูุง ููุฌูุฏ
ุฏุฑ development environmentุ ูุงูโูุง ูุงฺฏุฑุดู ุงุตูุงุญ ุดุฏูุฏ:

- โ `0030_add_disabled_field_to_chatmessage.py` - ููุฌูุฏ ุงุณุช
- โ `0031_messagefile.py` - ุญุฐู ุดุฏ
- โ `0032_limitationmessage.py` - ูุงุจุณุชฺฏ ุงุตูุงุญ ุดุฏ
- โ `0033_add_auto_generate_title_field.py` - ุตุญุญ ุงุณุช
- โ `0034_messagefile.py` - ุฌุฏุฏ ุงุฌุงุฏ ุดุฏ

### 2. ุชุบุฑุงุช ุงูุฌุงู ุดุฏู

#### ุงูู) ุงุตูุงุญ ูุงฺฏุฑุดู 0032
```python
# ูุจู ุงุฒ ุงุตูุงุญ
dependencies = [
    ("chatbot", "0031_messagefile"),
]

# ุจุนุฏ ุงุฒ ุงุตูุงุญ  
dependencies = [
    ("chatbot", "0030_add_disabled_field_to_chatmessage"),
]
```

#### ุจ) ุงุฌุงุฏ ูุงฺฏุฑุดู ุฌุฏุฏ 0034
- ูุงฺฏุฑุดู `MessageFile` ุฏูุจุงุฑู ุฏุฑ ูุงู `0034_messagefile.py` ุงุฌุงุฏ ุดุฏ
- ูุงุจุณุชฺฏ ุขู ุจู `0033_add_auto_generate_title_field` ุชูุธู ุดุฏ

## ๐ ูุฑุงุญู ุงุนูุงู ุฏุฑ Production

### ฺฏุงู 1: ุจุฑุฑุณ ูุงฺฏุฑุดูโูุง ููุฌูุฏ ุฏุฑ ุณุฑูุฑ
```bash
python manage.py showmigrations chatbot
```

### ฺฏุงู 2: ฺฉ ุงุฒ ุฑูุดโูุง ุฒุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ

#### ุฑูุด A: ุงุนูุงู ูุงฺฏุฑุดูโูุง ุงุตูุงุญ ุดุฏู (ูพุดููุงุฏ)

1. ูุงูโูุง ูุงฺฏุฑุดู ุงุตูุงุญ ุดุฏู ุฑุง ุขูพููุฏ ฺฉูุฏ:
   - `chatbot/migrations/0032_limitationmessage.py`
   - `chatbot/migrations/0034_messagefile.py`

2. ุงุนูุงู ูุงฺฏุฑุดูโูุง:
```bash
# ุฎุดฺฉ ุชุณุช ฺฉุฑุฏู
python manage.py migrate --dry-run

# ุงุนูุงู ูุงูุน
python manage.py migrate
```

#### ุฑูุด B: ุงุนูุงู ุฏุณุช ูุงฺฏุฑุดู (ุฏุฑ ุตูุฑุช ูุดฺฉู)

ุงฺฏุฑ ูููุฒ ูุดฺฉู ุฏุงุฑุฏุ ุงู ุฏุณุชูุฑุงุช ุฑุง ุงุฌุฑุง ฺฉูุฏ:

```bash
# ุนูุงูุชโฺฏุฐุงุฑ ูุงฺฏุฑุดูโูุง ฺฉู ูุดฺฉู ุฏุงุฑูุฏ
python manage.py migrate chatbot 0030 --fake

# ุงุฌุงุฏ ุฌุฏููโูุง ุฌุฏุฏ ุจู ุตูุฑุช ุฏุณุช (ุงฺฏุฑ ูุงุฒ ุจุงุดุฏ)
python manage.py sqlmigrate chatbot 0032
python manage.py sqlmigrate chatbot 0034

# ุงุนูุงู ูุงฺฏุฑุดูโูุง
python manage.py migrate chatbot
```

#### ุฑูุด C: ุฑุณุช ฺฉุงูู ูุงฺฏุฑุดูโูุง (ุขุฎุฑู ุฑุงู ุญู)

โ๏ธ **ุงุญุชุงุท**: ุงู ุฑูุด ููุท ุงฺฏุฑ ุฏุงุฏูโูุง ููู ูุฏุงุฑุฏ ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
# ุจฺฉุงูพ ุฏุชุงุจุณ
pg_dump your_database > backup.sql

# ุญุฐู ูุงฺฏุฑุดูโูุง ูุดฺฉูโุฏุงุฑ
rm chatbot/migrations/0031_messagefile.py

# ุงุฌุงุฏ ูุงฺฏุฑุดู ุฌุฏุฏ
python manage.py makemigrations chatbot

# ุงุนูุงู ูุงฺฏุฑุดูโูุง
python manage.py migrate
```

## ๐ ุจุฑุฑุณ ุตุญุช ุงุนูุงู

ุจุนุฏ ุงุฒ ุงุนูุงูุ ุงู ููุงุฑุฏ ุฑุง ุจุฑุฑุณ ฺฉูุฏ:

```bash
# ุจุฑุฑุณ ูุถุนุช ูุงฺฏุฑุดูโูุง
python manage.py showmigrations chatbot

# ุชุณุช ุงุฌุงุฏ MessageFile
python manage.py shell
>>> from chatbot.models import MessageFile
>>> MessageFile.objects.all()

# ุชุณุช ุงุฌุงุฏ LimitationMessage
>>> from chatbot.models import LimitationMessage
>>> LimitationMessage.objects.all()
```

## ๐ ฺฺฉ ูุณุช

- [ ] ุจฺฉุงูพ ุงุฒ ุฏุชุงุจุณ ุชูู ุดุฏู
- [ ] ูุงูโูุง ูุงฺฏุฑุดู ุงุตูุงุญ ุดุฏู ุขูพููุฏ ุดุฏู
- [ ] `python manage.py migrate --dry-run` ูููู ุงุณุช
- [ ] `python manage.py migrate` ุงุฌุฑุง ุดุฏู
- [ ] `python manage.py showmigrations` ููู ูุงฺฏุฑุดูโูุง ุฑุง applied ูุดุงู ูโุฏูุฏ
- [ ] ูุฏูโูุง ุฌุฏุฏ ูุงุจู import ู ุงุณุชูุงุฏู ูุณุชูุฏ

## ๐ ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุดฺฉู

ุงฺฏุฑ ูุดฺฉู ูพุด ุขูุฏ:

1. ุฏุชุงุจุณ ุฑุง ุงุฒ ุจฺฉุงูพ ุจุงุฒฺฏุฑุฏุงู ฺฉูุฏ
2. ูุงฺฏโูุง ุฎุทุง ุฑุง ฺฺฉ ฺฉูุฏ
3. ุฏุณุชูุฑ `python manage.py showmigrations` ุฑุง ุงุฌุฑุง ฺฉูุฏ
4. ุจุง ุชู ูพุดุชุจุงู ุชูุงุณ ุจฺฏุฑุฏ

## ๐ ูฺฉุงุช ููู

- ููุดู ูุจู ุงุฒ ุงุนูุงู ูุงฺฏุฑุดูโูุง ุจฺฉุงูพ ุชูู ฺฉูุฏ
- ุงุจุชุฏุง ุฏุฑ ูุญุท staging ุชุณุช ฺฉูุฏ
- ุฏุฑ ุณุงุนุงุช ฺฉูโุชุฑุงูฺฉ ุงุนูุงู ฺฉูุฏ
- ูุงูุชูุฑูฺฏ ุฑุง ุฏุฑ ุทูู ูุฑุขูุฏ ูุนุงู ูฺฏู ุฏุงุฑุฏ